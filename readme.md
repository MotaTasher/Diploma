# Isupov Matvei

Да, я тут пытаюсь написать диплом. Тут буду говорить о том, что я сделал 


# Прогресс

## До 2024.10.14

### Заметки
Получил пулл статей, которые надо было читать 

[MIXED-TYPE TABULAR DATA SYNTHESIS WITH
SCORE-BASED DIFFUSION IN LATENT SPACE
](https://arxiv.org/pdf/2310.09656) (прочитал, прикольно, но зачем)

[Learning Conditional Variational Autoencoders with Missing Covariates](https://arxiv.org/pdf/2203.01218) (прочитал половину. Формально релевантная таска, но какие-то странные подходы они берут. Но пусть будет. Тоже заче?)

[CSDI: Conditional Score-based Diffusion Models for
Probabilistic Time Series Imputation](https://arxiv.org/pdf/2107.03502) (не читал ещё)

[Large Language Models Are
Zero-Shot Time Series Forecasters](https://arxiv.org/pdf/2310.07820) (ещё не читал)

[MultiCast: Zero-Shot Multivariate Time Series
Forecasting Using LLMs](https://arxiv.org/pdf/2405.14748)
(ещё не читал )

Получил ссылку на гит-репу для дампа данных

[cryo](https://github.com/paradigmxyz/cryo)

## 2024.10.14 - 2024.10.21

Либа `cryo` показалась очень неудобной. Дампаю самостоятельно

[Сайт, откуда дампаю](https://app.infura.io/)
(нужно следить, чтоб не привысить лимиты по дампу)

### Что удалось сделать:
1) Выгружен gpt2 с hugging face (там данные обновлялись не поздее, чем 2 года назад. На сколько там что-то хорошее пока утверждать не могу), запущен в исходном виде на тексте, что-то выдает. На вопрос "как его перестроить для обучения на крипторынке" ничего полезного не дал, придётся самому решать вопросик
2) cryo скачал, подолбился в него, создал себе токен для общения с infura. cryo какие-то данные выгружает, но сделки через него так и не получилось выгрузить, только логи/блоки
3) Выгрузил данные напрямую с infura. В день лимит на ~10^4 транзакций. Постепенно буду выкачивать их
4) Оставил дополнительно к timestamp, id_from, id_to, value ещё локальные 'nonce' (число транзакций, отправленных этим адресом), 'type' (тип транзакции)
5) Дальше запущу гпт/bert на этих данных

## 2024.10.21 - 2024.10.28

### Заметки
Повезло, лекции в шаде рассказали про атеншен и конкретно берту, fine-tuning, очень вовремя получилось повторить

Написал себе логер, начал раскидывать код по папкам, вести прогресс


### План
Нужно: построить пайплайн fine-tuning/traing bert-ы. Настроить пайплайн выкачивания данных в одну команду. Разобраться, какие данные нужны. Дочитать вторую статью

### Что удалось сделать:
1) сделал скрипт для выкачки данных, теперь буду по утрам его запускать, чтоб тянул данные

2) Подготовил простую предобработку данных:
    
    a) выделил по адресам тех, кто сделал больше N_1 транзакций за выбранный этап, остальных мечу как неизвестных. От них беру эмбединги
    
    b) Учу эмбединги по времени (подаю год, месяц, день недели, число, часы, минуты, секунды, абсолютное значение)
    
    c) nonce, index, type подаю сейчас как числовые фичи (так конечно делать плохо, но пока ставил себе цель собрать хоть какой-то пайплайн) 
    
    d) подаю на вход N_2 подряд идущих данных, по ним пытаюсь предсказать их  log (value + eps) (тут таргет тоже сомнительный, хочется маскировать какие-то объёмы, а не просто учить по времени, когда они были больше, когда меньше)

3) Собрал обёртку над бертом. Заставил лосс пока взял как MSE (на плохой таргет взял плохой лосс)

4) Поставил сейчас на обучение. С точки зрения собраности кода - работает. С точки зрения обучения - пока не могу сказать
5) Тривиальных бейзлайнов пока не сделал, бейзлайнов нет. Пока не могу оценить её успехи. Просто есть что-то, на что можно тратить терафлопсы 
(посмотрел её предикты, почему-то пытается всё одной константой запредиктить. Буду разбираться почему. Большинство сделок маленький. Нужно выбирать другой таргет. Причём хорошенько над ним подумать)